<div class="row" [hidden]="openBookMarks">
  <div class="col-md-12">
    <div class="card">
      <div class="card-block main-card-block">
          <div class="border-bt">
            <h2 class="main-title">Set Account Control Details</h2>
            <app-breadcrumb [routeChange]="routeChange"></app-breadcrumb>
          </div>        
      </div>
      <div class="card-body">
        <div class="card-block ml-md-3 mr-md-3 ml-1 mr-1 mt-4">
          <aw-wizard [navBarLayout]="'large-filled-symbols'">
            <aw-wizard-step stepTitle="Details" [navigationSymbol]="{ symbol: '1' }">
              <form class="form inner-form" #f="ngForm" novalidate>
                <div class="form-body">
                  <div class="block-button">
                    <a class="btn btn-gradient mt-3 mb-0" (click)="addNewAccount();" href="javascript:void(0)">
                      <i class="fa fa-user-plus"></i> Add Approval Accounts</a>
                  </div>
                  <div class="row">
                    <div class="col-md-6 mt-3" *ngFor="let account of setAccountControlForm.approveAccounts; trackBy:indexTracker; index as i">
                      <div class="form-group mb-0">
                       <div class="input-group m-0 sign_in_inputs row form-border-bottom pb-1">
                        <div class="col-10 col-lg-11">        
                          <input type="text" class="pl-0 mb-0 pt-0 pb-0 form-control" placeholder="XIN - _____ - _____ - _____ - _____" name="account-{{i}}" [(ngModel)]="setAccountControlForm.approveAccounts[i].value" #accountRs="ngModel" required>
                        </div>
                          <div class="col-2 col-lg-1">
                            <span class="btn btn-grey" triggers="mouseenter:mouseleave" placement="top" (click)="loadBookmarkView(i)" container="body"
                              ngbPopover="Open your bookmarks to insert an account id">
                              <i class="fa fa-address-card"></i>
                            </span>
                          </div>
                        </div>

                        <div *ngIf="accountRs?.invalid && (accountRs?.dirty || accountRs?.touched)" class="input-error">
                          <div *ngIf="accountRs?.errors.required">
                            Account RS is required
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="row mt-3">
                    <div class="col-md-6">
                      <div class="form-group m-0">
                        <label>Minimum Approval Accounts (Quorum)
                          <i class="fa fa-question-circle-o" triggers="mouseenter:mouseleave" placement="right" container="body" ngbPopover="The amount you like to send to the recipient account.">
                          </i>
                        </label>
                         <div class="input-group m-0 sign_in_inputs row form-border-bottom pb-1">
                          <div class="col-11"> 
                          <input type="number" class="pl-0 mb-0 pt-0 pb-0 form-control" [(ngModel)]="setAccountControlForm.quorum" name="quorum" #quorum="ngModel" placeholder="2"
                            required minValue="2" maxValue="9">
                          </div>

                         <div class="col-1 pl-0"> 
                            <span class="input-group-text">
                              <i class="fa fa-users"></i>
                            </span>
                          </div>
                        </div>
                        <div *ngIf="quorum?.invalid && (quorum?.dirty || quorum?.touched)" class="input-error">
                          <div *ngIf="quorum?.errors.required">
                            Quorum is required
                          </div>
                          <div *ngIf="quorum?.errors.minValue && !quorum?.errors.required">
                            Quorum must be greater than equal to 2
                          </div>
                          <div *ngIf="quorum?.errors.maxValue && !quorum?.errors.required">
                            Quorum must be less than equal to 9
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="left mt-4">
                  <button [disabled]="f.invalid" type="button" class="btn btn-gradient mr-1 mb-0 float-right" (click)="validateForm()" awNextStep>
                    <i class="fa fa-chevron-right"></i> Next
                  </button>
                </div>
              </form>
            </aw-wizard-step>
            <aw-wizard-step stepTitle="Confirm" [navigationSymbol]="{ symbol: '2' }" class="form-bordered mt-4">
              <div class="row">
                <div class="col-md-4">
                  <div class="ucsb"> Control Model
                  </div>
                  <h4> Account Approval </h4>
                </div>
                <div class="col-md-4">
                  <div class="ucsb"> Control Approval Accounts
                  </div>
                  <div>
                    <h4 *ngFor="let account of setAccountControlForm.approveAccounts">
                      {{account.value}}
                    </h4>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="ucsb"> Quorum
                  </div>
                  <h4> {{setAccountControlForm.quorum}} </h4>
                </div>
              </div>
             
              <div class="row">
                <div class="col-md-4">
                  <div class="ucsb"> Valid
                  </div>
                  <h4 [innerHTML]="validBytes | txIsValid"></h4>
                </div>
                <div class="col-md-4">
                  <div class="ucsb"> Service Fee
                  </div>
                  <h4>{{tx_fee | amountTkn}}
                    <small> XIN</small>
                  </h4>
                </div>
              </div>
             
              <button type="button" [ngClass]="{'btn-success': !unsignedTx, 'btn-danger': unsignedTx}" class="btn btn-raised mr-1 mb-0"
                (click)="unsignedTx = !unsignedTx">
                <i class="fa fa-key"></i> Signed Transaction
              </button>
             
              <div class="form-group mt-4" *ngIf="unsignedTx">
                <div class="position-relative sign_in_inputs">
                  <textarea disabled="true" rows="3" type="text" [(ngModel)]="transactionBytes" class="form-control pl-0" name="key"></textarea>
                </div>
              </div>
              <div class="form-actions">
                <button type="button" [disabled]="!validBytes" class="btn btn-gradient float-right" (click)="broadcastTransaction(transactionBytes)">
                  <i class="fa fa-check"></i> Finish
                </button>
                <button type="button" class="btn btn-gradient mr-1 float-right" awPreviousStep>
                  <i class="fa fa-chevron-left"></i> Previous
                </button>
              </div>
            </aw-wizard-step>
          </aw-wizard>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row" *ngIf="openBookMarks">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title">My Bookmarks</h4>
        <h5 class="back-button" (click)="goBack()">
          <i class="fa fa-chevron-left"></i> Back
        </h5>
      </div>
      <div class="card-body">
        <div class="card-block ml-1 mr-1 ml-md-3 mr-md-3">
          <h5 class="mb-1">Bookmark List</h5>
          <app-bookmark-list [viewFor]="'sendxin'" (selectEvent)="bookmarkSelected($event)"></app-bookmark-list>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row" *ngIf="!openBookMarks">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title">Pending Approval Request</h4>
        <div class="pull-right filter-group">
          <div class="btn-group btn-group-justified btn-group-raised">
            <a href="javascript:void(0)" class="btn btn-sm btn-grey" (click)="reload()" triggers="mouseenter:mouseleave" container="body"
              placement="top" ngbPopover="Reload">
              <i class="fa fa-refresh"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="card-block">
          <ngx-datatable class="material" [rows]="rows" [columnMode]="'force'" [rowHeight]="'auto'" [footerHeight]="50" [externalPaging]="true"
            [count]="page.totalElements" [offset]="page.pageNumber" [limit]="page.size" (page)='setPage($event)' (autoRefresh)="reload()">
            <ngx-datatable-column prop="timestamp" name="Date">
              <ng-template let-value="value" ngx-datatable-cell-template>
                {{value | timestamp}}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="type" name="Type">
              <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
                <div [innerHTML]="value | transactionIconSubType: row.subtype">
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="amountTQT" name="Amount">
              <ng-template let-value="value" ngx-datatable-cell-template>
                {{value | amountTqt }}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="confirmations" name="Conf.">
              <ng-template let-value="value" ngx-datatable-cell-template>
                <div [innerHTML]="value | transactionConf">
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="confirmations" name="Message">
              <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
                <div [innerHTML]="value | isMessage: row.subtype">
                </div>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="attachment.phasingFinishHeight" name="Height">
              <ng-template let-value="value" ngx-datatable-cell-template>
                {{value}}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="senderRS" name="Sender">
              <ng-template let-value="value" ngx-datatable-cell-template>
                <a class="hyperlink" (click)="accountDetail(value)">{{value}}</a>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="recipientRS" name="Recipient">
              <ng-template let-value="value" ngx-datatable-cell-template>
                <a class="hyperlink" (click)="accountDetail(value)">{{value}}</a>
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column prop="timestamp" name="Actions">
              <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
                <div class="btn-group-raised">
                <a class="btn btn-sm btn-grey btn-icon" (click)="goToDetails(row)" triggers="mouseenter:mouseleave" container="body" placement="top"
                  ngbPopover="Details">
                  <i class="fa fa-list-ul"></i>
                </a>
                <a class="btn btn-sm btn-grey btn-icon" (click)="goToApproveRequest(row)" triggers="mouseenter:mouseleave" container="body" placement="top"
                   ngbPopover="Approve Request">
                  <i class="fa fa-unlock"></i>
                </a>
              </div>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </div>
      </div>
    </div>
  </div>
</div>