<div class="card-header">
	<h3 class="card-title">{{'account.send-xin.reference-title'| translate}}</h3>
</div>
<div class="card-body mt-4">
	<div class="card-block ml-1 mr-1 ml-md-3 mr-md-3">
		<aw-wizard [navBarLayout]="'large-filled-symbols'">
			<aw-wizard-step stepTitle="{{'account.send-xin.details-step'| translate}}" [navigationSymbol]="{ symbol: '&#xe93a;', fontFamily: 'icomoon' }">
				<form class="form inner-form" #f="ngForm" novalidate>
					<div class="form-body">
						<div class="row">
							<div class="col-md-6">
								<div class="form-group m-0">
									<label>{{'account.send-xin.recipient-lable'| translate}}

										<i class="fa fa-question-circle-o ml-1 info-yellow" placement="right"
										   triggers="mouseenter:mouseleave" container="body"
										   ngbPopover="{{'account.send-xin.recipient-tooltip'| translate}}"></i>
									</label>
									<div class="input-group ml-0 mr-0 sign_in_inputs row form-border-bottom pb-1">
										<div class="col-7 col-lg-8 pl-0">
											<input type="text" class="pl-0 mb-0 pt-0 pb-0 form-control"
											       [(ngModel)]="sendReferencedForm.recipientRS"
											       name="recipientRS" #recipientRS="ngModel" required
											       placeholder="XIN - _____ - _____ - _____ - _____">
										</div>
									<div class="col-5 col-lg-4 pr-1 pl-0">
											<div class="btn-icon-group text-right">
											
													<span *isAppEnabled="'Aliases'" class="btn btn-primary btn-seperator" (click)="searchAliases()" triggers="mouseenter:mouseleave" placement="top" container="body" ngbPopover="{{'account.send-xin.alias-connect-tooltip'| translate}}">
														<i class="fa fa-share-alt"></i>
													</span>
												

												
													<span *isExpertView="true" class="btn btn-primary btn-left" triggers="mouseenter:mouseleave" placement="top" (click)="loadBookmarkView()" container="body" ngbPopover="{{'account.send-xin.open-bookmark-tooltip'| translate}}">
														<i class="fa fa-bookmark"></i>
													</span>
												
											</div>
										</div>

										<div *ngIf="recipientRS?.invalid && (recipientRS?.dirty || recipientRS?.touched)"
										     class="input-error">
											<div *ngIf="recipientRS?.errors.required">
												Recipient address is required
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group m-0">
									<label>{{'account.send-xin.amount-lable'| translate}}
										<i class="fa fa-question-circle-o ml-1 info-yellow" placement="right"
									                 triggers="mouseenter:mouseleave" container="body"
									                 ngbPopover="{{'account.send-xin.amount-tooltip'| translate}}"></i>
									</label>
									<div class="input-group m-0 sign_in_inputs row form-border-bottom pb-1">
										 <div class="col-10 pl-0"> 
											<input type="number" class="pl-0 mb-0 pt-0 pb-0 form-control"
											       [(ngModel)]="sendReferencedForm.amount"
											       name="amount" #amount="ngModel" required minValue="1">

										</div>
										<div class="col-1">
											<div class="input-group-append">
												<span class="input-group-text">XIN</span>
											</div>
										</div>

									</div>
									<div *ngIf="amount?.invalid && (amount?.dirty || amount?.touched)"
									     class="input-error">
										<div *ngIf="amount?.errors.required">
											Amount is required
										</div>
										<div *ngIf="amount?.errors.minValue && !amount?.errors.required">
											Amount must be greater than 0
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="form-group mt-4">
							<label>{{'account.send-xin.number-blocks-lable'| translate}} &nbsp;
								<i class="fa fa-question-circle-o" placement="right"
								   triggers="mouseenter:mouseleave" container="body"
								   ngbPopover="{{'account.send-xin.number-blocks-tooltip'| translate}}"></i>
							</label>
							<div class="input-group row">
								<div class="col-md-2">
									<span class="input-group-text">BLOCK : {{ sendReferencedForm.currentHeight }}</span>
								</div>
								<div class="col-md-6 sign_in_inputs ">
									<input type="text" class="form-control pl-0"
									       placeholder="1440" name="blockheight"
									       [(ngModel)]="sendReferencedForm.deferredHeight">
								</div>
								<div class="col-md-1">
									<span class="input-group-text"> {{ days }} Day(s)</span>
								</div>
								<div class="col-md-3 btn-icon-group text-right pr-1 text-sm-center">
									<a class="btn btn-primary" (click)="min()">
										<i class="fa fa-fast-backward"></i>
									</a>
									<a class="btn btn-primary" (click)="decrement()">
										<i class="fa fa-minus"></i>
									</a>
									<a class="btn btn-primary" (click)="increment()">
										<i class="fa fa-plus"></i>
									</a>
									<a class="btn btn-primary" (click)="max()">
										<i class="fa fa-fast-forward"></i>
									</a>


								</div>
							</div>

						</div>
						<!-- <hr> -->
						<div class="form-group">
							<label> {{'account.send-xin.reference-full-hash-lable'| translate}}&nbsp;
								<i class="fa fa-question-circle-o" placement="right"
								   triggers="mouseenter:mouseleave" container="body"
								   ngbPopover="{{'account.send-xin.reference-full-hash-tooltip'| translate}}"></i>
							</label>
							<div class="input-group sign_in_inputs row form-border-bottom ml-1">
								<div class="col-10 pl-0">
									<input type="text" class="form-control p-0"
								       placeholder="type in the HASH" name="fullhash"
								       [(ngModel)]="sendReferencedForm.fullHash">
								</div>
								<div class="col-2 text-right">
									<div class="input-group-append" required>
									<span class="input-group-text"> HASH </span>
								</div>
								</div>
								
								
							</div>
						</div>
						
						<button type="button"
						        [ngClass]="{'btn-success': !hasPrivateMessage, 'btn-danger': hasPrivateMessage}"
						        class="btn btn-raised mr-1 mb-0"
						        (click)="setMessage()">
							<i class="fa fa-envelope"></i> {{ hasPrivateMessage ? 'Remove' : 'Add' }}{{'account.send-xin.private-message-btn'| translate}}
						</button>
						<button type="button"
						        [ngClass]="{'btn-success': !hasReceiverPublicKey, 'btn-danger': hasReceiverPublicKey}"
						        class="btn btn-raised mb-0"
						        (click)="setPublicKey()">
							<i class="fa fa-key"></i> {{ hasReceiverPublicKey ? 'Remove' : 'Add' }}{{'account.send-xin.public-key-btn'| translate}}
						</button>
						<!-- <hr *ngIf="hasPrivateMessage || hasReceiverPublicKey"> -->
						<div class="form-group mt-4" *ngIf="hasPrivateMessage">
							<label>{{'account.send-xin.message-field-lable'| translate}}
								<i class="fa fa-question-circle-o" placement="right"
								   triggers="mouseenter:mouseleave" container="body"
								   ngbPopover="{{'account.send-xin.message-field-tooltip'| translate}}">
								</i>
							</label>
							<div class="position-relative sign_in_inputs">
								<input [(ngModel)]="sendReferencedForm.message" rows="5" class="form-control pl-0"
								       name="message">
							</div>
						</div>
						<div class="form-group" *ngIf="hasReceiverPublicKey">
							<label>{{'account.send-xin.public-key-field-lable'| translate}}
								<i class="fa fa-question-circle-o" placement="right"
								   triggers="mouseenter:mouseleave" container="body"
								   ngbPopover="{{'account.send-xin.public-key-field-tooltip'| translate}}">
								</i>
							</label>
							<div class="position-relative sign_in_inputs">
								<input [(ngModel)]="sendReferencedForm.pubkey" type="text" class="form-control pl-0"
								       name="publickey">
							</div>
						</div>

					</div>
					<div class="right mt-4">
						<button [disabled]="f.invalid" type="button" class="btn btn-gradient mr-1 mb-0 float-right"
						        (click)="getAndVerifyAccount(sendReferencedForm);"
						        awNextStep>
							{{'account.send-xin.next-btn'| translate}} <i class="icon-next_arrow"></i>
						</button>
					</div>
				</form>
			</aw-wizard-step>
			<aw-wizard-step stepTitle="{{'account.send-xin.confirm-step'| translate}}" [navigationSymbol]="{ symbol: '&#xe939;', fontFamily: 'icomoon' }" class="form-bordered mt-4">
				<div class="row">
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.recipient-account-lable'| translate}}
						</div>
						<h4> {{sendReferencedForm.recipientRS}} </h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.recipient-name-lable'| translate}}
						</div>
						<h4> {{accountDetails.name | notSet}} </h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.recipient-balance-lable'| translate}}
						</div>
						<h4> {{accountDetails.balanceTQT | amountTqt}}
							<small> XIN</small>
						</h4>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.token-send-lable'| translate}}
						</div>
						<h4> {{tx_amount | amountTkn}}
							<small> XIN</small>
						</h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.service-fee-lable'| translate}}
						</div>
						<h4> {{ tx_fee | amountTkn }}
							<small> XIN</small>
						</h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.token-total-lable'| translate}}
						</div>
						<h4> {{ tx_total | amountTkn }} </h4>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.valid-lable'| translate}}
						</div>
						<h4 [innerHTML]="validBytes | txIsValid"></h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.message-added-lable'| translate}}
						</div>
						<h4 [innerHTML]="hasMessageAdded | isEnabled"></h4>
					</div>
					<div class="col-md-4">
						<div class="ucsb"> {{'account.send-xin.public-key-added-lable'| translate}}
						</div>
						<h4 [innerHTML]="hasPublicKeyAdded | isEnabled"></h4>
					</div>
				</div>
				<button type="button" [ngClass]="{'btn-success': !unsignedTx, 'btn-danger': unsignedTx}"
				        class="btn btn-raised mr-1 mb-0"
				        (click)="unsignedTx = !unsignedTx">
					<i class="fa fa-key"></i> {{'account.send-xin.signed-transaction-lable'| translate}}
				</button>
				<button type="button" [ngClass]="{'btn-success': !addMessage, 'btn-danger': addMessage}"
				        class="btn btn-raised mb-0" (click)="addMessage=!addMessage">
					<i class="fa fa-key"></i> {{'account.send-xin.encrypted-message-lable'| translate}}
				</button>
				<hr *ngIf="unsignedTx || addMessage">
				<div class="form-group" *ngIf="unsignedTx">
					<label>{{'account.send-xin.signed-transaction-lable'| translate}}</label>
					<div class="position-relative">
                          <textarea disabled="true" rows="3" type="text" [(ngModel)]="transactionBytes"
                                    class="form-control" name="key"></textarea>
					</div>
				</div>
				<div class="form-group" *ngIf="addMessage">
					<label>{{'account.send-xin.encrypted-message-lable'| translate}}</label>
					<div class="position-relative">
						<input disabled="true" rows="5" [(ngModel)]="encrypted" class="form-control" name="message">
					</div>
				</div>
				<div class="mt-4">
					<button type="button" [disabled]="!validBytes" (click)="broadcastTransaction(transactionBytes)"
					        class="btn btn-gradient float-right">
						<i class="fa fa-check"></i> {{'account.send-xin.finish-btn'| translate}}
					</button>
					<button type="button" class="btn btn-gradient mr-1 float-right" awPreviousStep>
						<i class="fa fa-chevron-left"></i> {{'account.send-xin.previous-btn'| translate}}
					</button>
				</div>
			</aw-wizard-step>
		</aw-wizard>
	</div>
</div>
